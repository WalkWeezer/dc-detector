# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç Camera Service

## –ß—Ç–æ —ç—Ç–æ?

Camera Service - —ç—Ç–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞–º–µ—Ä–∞–º–∏. –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–π —Ç–∏–ø –∫–∞–º–µ—Ä—ã –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫ —á–µ—Ä–µ–∑ HTTP.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã (PiCamera ‚Üí Picamera2 ‚Üí USB –≤–µ–±-–∫–∞–º–µ—Ä–∞)
- üì∏ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PiCamera (legacy)
- üì∑ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Picamera2  
- üåê –ü–æ–¥–¥–µ—Ä–∂–∫–∞ USB –≤–µ–±-–∫–∞–º–µ—Ä
- üé• MJPEG –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫
- üìä REST API –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### –í–∞—Ä–∏–∞–Ω—Ç 1: Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
cd camera-service
docker-compose up -d --build
```

–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: **http://localhost:8000**

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ù–∞—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ (–¥–ª—è Raspberry Pi)

```bash
cd camera-service
pip3 install -r requirements.txt
python3 camera_server.py
```

## üì° API Endpoints

- `GET /` - –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–æ–º
- `GET /video_feed` - MJPEG –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫ (–¥–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- `GET /status` - JSON —Å—Ç–∞—Ç—É—Å –∫–∞–º–µ—Ä—ã
- `GET /health` - Health check

## üìñ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–∞ –≤ HTML

```html
<img src="http://camera-service:8000/video_feed" alt="Camera Stream">
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —á–µ—Ä–µ–∑ curl

```bash
curl http://localhost:8000/status
```

–û—Ç–≤–µ—Ç:
```json
{
  "camera_type": "webcam",
  "running": true,
  "status": "active"
}
```

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏

```bash
docker-compose logs -f
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker-compose ps
```

### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å

```bash
docker-compose down
```

## üìù –ü–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞–º–µ—Ä

–°–µ—Ä–≤–∏—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–º–µ—Ä—ã –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ:
1. **PiCamera** (legacy) - —Å—Ç–∞—Ä–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è Raspberry Pi
2. **Picamera2** - –Ω–æ–≤–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è Raspberry Pi  
3. **USB WebCam** - –æ–±—ã—á–Ω—ã–µ –≤–µ–±-–∫–∞–º–µ—Ä—ã —á–µ—Ä–µ–∑ OpenCV

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –Ω–∞ Raspberry Pi –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ PiCamera, –∞ –Ω–∞ –¥—Ä—É–≥–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö - USB –≤–µ–±-–∫–∞–º–µ—Ä–∞.

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

–ù–∞ Raspberry Pi –¥–ª—è —Ä–∞–±–æ—Ç—ã –∫–∞–º–µ—Ä—ã –Ω—É–∂–Ω–æ:
- –í–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É: `sudo raspi-config` ‚Üí Interface Options ‚Üí Camera ‚Üí Enable
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–º–µ—Ä—É: `libcamera-hello --timeout 2000`

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: `TypeError: kwargs_from_env() got an unexpected keyword argument 'ssl_version'`

–ï—Å–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ `docker-compose up -d --build` –≤–æ–∑–Ω–∏–∫–∞–µ—Ç —ç—Ç–∞ –æ—à–∏–±–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –∫–æ–º–∞–Ω–¥—É Docker:

```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ docker compose (–±–µ–∑ –¥–µ—Ñ–∏—Å–∞) –≤–º–µ—Å—Ç–æ docker-compose
docker compose up -d --build
```

–ò–ª–∏ –æ–±–Ω–æ–≤–∏—Ç–µ docker-compose –Ω–∞ Raspberry Pi:

```bash
sudo pip3 uninstall docker-compose -y
sudo pip3 install docker-compose==1.29.2
```

### –ö–æ–º–∞–Ω–¥—ã —Å docker compose (–Ω–æ–≤—ã–π —Å–ø–æ—Å–æ–±)

–í—Å–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã—à–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∏ —Å –Ω–æ–≤–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º:
- `docker compose up -d --build` - –∑–∞–ø—É—Å–∫
- `docker compose logs -f` - –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
- `docker compose ps` - —Å—Ç–∞—Ç—É—Å
- `docker compose down` - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞

## üéØ –ß—Ç–æ –¥–∞–ª—å—à–µ?

–≠—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å - –æ—Å–Ω–æ–≤–∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:
- **Detection Service** - –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫ –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–≥–Ω—è
- **API Gateway** - –±—É–¥–µ—Ç –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –∫–∞–º–µ—Ä–µ
- **Storage Service** - –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∑–∞–ø–∏—Å–∏ –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏

