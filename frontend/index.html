<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>DC-Detector — мониторинг</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="page">

      <main class="tab-container">
        <section id="tab-stream" class="tab-panel active" role="tabpanel">
          <div class="stream-grid">
            <div class="video-panel">
              <div class="video-wrapper">
                <img id="server-stream" alt="Live stream" />
                <canvas id="overlay"></canvas>
              </div>
              <div class="status-bar">
                <div class="status-item">
                  <span>Состояние</span>
                  <strong id="status-indicator">Подключение…</strong>
                </div>
                <div class="status-item">
                  <span>Камера</span>
                  <strong id="camera-type">—</strong>
                </div>
                <div class="status-item">
                  <span>Детекций</span>
                  <strong id="detection-count">—</strong>
                </div>
                <div class="status-item">
                  <span>Макс. уверенность</span>
                  <strong id="detection-confidence">—</strong>
                </div>
              </div>
              <p id="error-message" class="status-error"></p>
            </div>

            <aside class="control-panel">
              <nav class="panel-tabs" role="tablist">
                <button class="panel-tab-button active" data-panel-tab="control" role="tab">Управление</button>
                <button class="panel-tab-button" data-panel-tab="database" role="tab">База</button>
              </nav>

              <div class="panel-tab-container">
                <div id="panel-tab-control" class="panel-tab-panel active" role="tabpanel">
                  <section class="panel-card">
                    <header>
                      <h2>Модель</h2>
                      <small id="active-model">—</small>
                    </header>
                    <form id="model-form" class="form-row">
                      <label class="form-field">
                        <span>Выберите модель</span>
                        <select id="model-select"></select>
                      </label>
                      <button type="submit" id="model-apply-btn">Применить</button>
                    </form>
                  </section>

                  <section class="panel-card">
                    <header>
                      <h2>Активные трекеры</h2>
                      <span id="tracker-refresh" class="link-like">Обновить</span>
                    </header>
                    <div id="tracker-list" class="tracker-list empty-state">
                      Нет активных трекеров
                    </div>
                  </section>

                  <section class="panel-card">
                    <header>
                      <h2>Управление</h2>
                    </header>
                    <div class="control-actions">
                      <label class="form-field">
                        <span>Текущий таргет</span>
                        <select id="target-select"></select>
                      </label>
                      <div class="action-buttons">
                        <button id="apply-target-btn" type="button">Назначить таргет</button>
                        <button id="save-detection-btn" type="button" class="accent">Сохранить детекцию</button>
                      </div>
                    </div>
                  </section>
                </div>

                <div id="panel-tab-database" class="panel-tab-panel" role="tabpanel">
                  <section class="panel-card">
                    <header>
                      <h2>Сохранённые детекции</h2>
                    </header>
                    <div class="database-toolbar">
                      <label class="form-field">
                        <span>Дата</span>
                        <input type="date" id="saved-screen-date" />
                      </label>
                      <div class="action-buttons">
                        <button id="saved-screen-refresh" type="button">Обновить</button>
                        <button id="saved-screen-clear" type="button" class="ghost" title="Очистить фильтр">Сбросить</button>
                      </div>
                    </div>
                    <div id="saved-screen-list" class="saved-grid" style="max-height: calc(100vh - 400px); overflow-y: auto; margin-top: 16px;"></div>
                  </section>
                </div>
              </div>
            </aside>
          </div>
        </section>

        <section id="tab-archive" class="tab-panel" role="tabpanel">
          <div class="archive-toolbar">
            <div class="toolbar-group">
              <label>
                Дата
                <input type="date" id="saved-screen-date" />
              </label>
              <button id="saved-screen-refresh">Обновить</button>
            </div>
            <div class="toolbar-group">
              <button id="saved-screen-clear" class="ghost" title="Очистить фильтр">Сбросить</button>
            </div>
          </div>
          <div id="saved-screen-list" class="saved-grid"></div>
        </section>
      </main>
    </div>

    <!-- Modal for GIF preview -->
    <div id="gif-modal" class="modal hidden" aria-hidden="true">
      <div class="modal-backdrop" id="gif-modal-backdrop"></div>
      <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="gif-modal-title">
        <button class="modal-close" id="gif-modal-close" aria-label="Закрыть">×</button>
        <div class="modal-body">
          <div class="modal-media">
            <img id="gif-modal-image" alt="GIF" />
          </div>
          <div class="modal-meta" id="gif-modal-meta">
            <h3 id="gif-modal-title">Детали сохранения</h3>
            <dl id="gif-modal-dl"></dl>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="./pi.js"></script>
  </body>
</html>


